@{
    ViewData["Title"] = "Home - Low Code Platform";
    ViewData["ActivePage"] = "Home";
    var models = ViewData["Models"] as Dictionary<string, Platform.Infrastructure.Definitions.ModelDefinition>;
    var pages = ViewData["Pages"] as Dictionary<string, Platform.Infrastructure.Definitions.PageDefinition>;
    var currentLang = Context.Request.Query["lang"].FirstOrDefault() ?? "en";
    var projectName = ViewData["ProjectName"] as string ?? "app";
}

<div class="container mx-auto px-4 py-8">
    <!-- é¡¹ç›®æ ‡é¢˜ -->
    <div class="text-center mb-12">
        <h1 class="text-4xl md:text-5xl font-bold text-gray-800 mb-4">
            @if (projectName == "todo")
            {
                <span>ğŸ“‹ TODO é¡¹ç›®ç®¡ç†</span>
            }
            else
            {
                <span>Welcome to Low Code Platform</span>
            }
        </h1>
        <p class="text-lg text-gray-600 max-w-2xl mx-auto mb-8">
            @if (projectName == "todo")
            {
                <span>é€šè¿‡ YAML å®šä¹‰é©±åŠ¨ï¼Œæ— éœ€ç¼–å†™ä»£ç å³å¯ç®¡ç†ä»»åŠ¡å’Œé¡¹ç›®</span>
            }
            else
            {
                <span>A modern platform for building data-driven applications with AI-powered features</span>
            }
        </p>
        
        @if (projectName != "app")
        {
            <div class="inline-block bg-blue-100 text-blue-800 px-4 py-2 rounded-lg">
                <span class="font-semibold">å½“å‰é¡¹ç›®ï¼š</span>@projectName
                <a href="/?LCP_PROJECT=app" class="ml-4 text-blue-600 underline">åˆ‡æ¢åˆ°é»˜è®¤é¡¹ç›®</a>
            </div>
        }
    </div>
</div>

    <!-- Feature Cards Section -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 mb-12">
        <div class="card dashboard-card text-white">
            <div class="flex items-start">
                <div class="bg-white bg-opacity-20 p-3 rounded-lg mr-4">
                    <i class="fas fa-database text-2xl"></i>
                </div>
                <div>
                    <h3 class="text-xl font-bold mb-2">Data Management</h3>
                    <p class="text-blue-100">Create, read, update, and delete data with our intuitive CRUD interface.</p>
                </div>
            </div>
        </div>

        <div class="card dashboard-card text-white">
            <div class="flex items-start">
                <div class="bg-white bg-opacity-20 p-3 rounded-lg mr-4">
                    <i class="fas fa-robot text-2xl"></i>
                </div>
                <div>
                    <h3 class="text-xl font-bold mb-2">AI-Powered Insights</h3>
                    <p class="text-blue-100">Leverage artificial intelligence for smarter decision-making.</p>
                </div>
            </div>
        </div>

        <div class="card dashboard-card text-white">
            <div class="flex items-start">
                <div class="bg-white bg-opacity-20 p-3 rounded-lg mr-4">
                    <i class="fas fa-shield-alt text-2xl"></i>
                </div>
                <div>
                    <h3 class="text-xl font-bold mb-2">Secure Validation</h3>
                    <p class="text-blue-100">Ensure data integrity with our three-layer architecture approach.</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Data Models Section -->
    <div class="mb-12">
        <h2 class="text-2xl font-bold text-gray-800 mb-6">Data Models</h2>
        @if (models != null && models.Any())
        {
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
                @foreach (var model in models)
                {
                    var modelKey = model.Key; // é¿å…Razorè§£æé”™è¯¯

                    // è·å–UIé…ç½®
                    var uiLabels = model.Value.Ui?.Labels;
                    Dictionary<string, string>? localizedLabels = null;

                    if (uiLabels != null)
                    {
                        if (currentLang == "zh" && uiLabels.Zh != null)
                        {
                            localizedLabels = uiLabels.Zh;
                        }
                        else if (currentLang == "en" && uiLabels.En != null)
                        {
                            localizedLabels = uiLabels.En;
                        }
                    }

                    if (localizedLabels == null)
                    {
                        localizedLabels = new Dictionary<string, string>();
                    }

                    var title = localizedLabels.ContainsKey("title") ? localizedLabels["title"] : modelKey;
                    var description = localizedLabels.ContainsKey("description") ? localizedLabels["description"] : $"Manage {modelKey} records";

                    var cardClass = model.Value.Ui?.Styles?.CardClass ?? "card";
                    var table = model.Value.Table;

                    // æ ¹æ®æ¨¡å‹åç§°é€‰æ‹©å›¾æ ‡
                    string iconClass = "fas fa-database";
                    if (modelKey.ToLower().Contains("customer") || modelKey.ToLower().Contains("user"))
                    {
                        iconClass = "fas fa-user-friends";
                    }
                    else if (modelKey.ToLower().Contains("product"))
                    {
                        iconClass = "fas fa-box-open";
                    }
                    else if (modelKey.ToLower().Contains("order") || modelKey.ToLower().Contains("invoice"))
                    {
                        iconClass = "fas fa-file-invoice-dollar";
                    }
                    else if (modelKey.ToLower().Contains("artist"))
                    {
                        iconClass = "fas fa-music";
                    }
                    else if (modelKey.ToLower().Contains("album"))
                    {
                        iconClass = "fas fa-compact-disc";
                    }
                    else if (modelKey.ToLower().Contains("track"))
                    {
                        iconClass = "fas fa-music";
                    }
                    else if (modelKey.ToLower().Contains("employee"))
                    {
                        iconClass = "fas fa-user-tie";
                    }
                    else if (modelKey.ToLower().Contains("genre"))
                    {
                        iconClass = "fas fa-tags";
                    }

                    <a href="/ui/@modelKey?lang=@currentLang" class="@(cardClass) rounded-xl p-6 text-center transition-all duration-300 border border-gray-200 hover:border-blue-300 hover:shadow-md">
                        <div class="bg-blue-100 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4">
                            <i class="@iconClass text-blue-600 text-xl"></i>
                        </div>
                        <h3 class="text-xl font-semibold text-gray-800 mb-2">@title</h3>
                        <p class="text-gray-600 text-sm mb-3">@description</p>
                        <div class="text-xs text-gray-500 mb-3">Table: @table</div>
                        <div>
                            <span class="inline-block px-3 py-1 bg-blue-100 text-blue-600 rounded-full text-xs font-medium">
                                Manage Data
                            </span>
                        </div>
                    </a>
                }
            </div>
        }
        else
        {
            <div class="text-center py-12">
                <div class="text-gray-400 mb-4">
                    <i class="fas fa-database text-6xl"></i>
                </div>
                <h3 class="text-xl font-medium text-gray-900 mb-2">No Models Defined</h3>
                <p class="text-gray-500">Configure your models in the app.yaml file</p>
            </div>
        }
    </div>

    <!-- Pages Section - å¤šè¡¨ CRUD é¡µé¢ -->
    @if (pages != null && pages.Any())
    {
        <div class="mb-12">
            <h2 class="text-2xl font-bold text-gray-800 mb-6">
                <i class="fas fa-th-large mr-2"></i>Pages (Multi-Table CRUD)
            </h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                @foreach (var page in pages)
                {
                    var pageKey = page.Key;
                    var pageTitle = page.Value.Title ?? pageKey;
                    var pageDesc = page.Value.Description ?? "";
                    var hasMultiTable = page.Value.MultiTableCrud != null;
                    var hasDataLoading = page.Value.DataLoading != null;

                    <a href="/page/@pageKey?lang=@currentLang" class="card rounded-xl p-6 transition-all duration-300 border border-purple-200 hover:border-purple-400 hover:shadow-md">
                        <div class="flex items-start">
                            <div class="bg-purple-100 p-3 rounded-lg mr-4">
                                <i class="fas fa-file-alt text-purple-600 text-xl"></i>
                            </div>
                            <div class="flex-1">
                                <h3 class="text-lg font-semibold text-gray-800 mb-1">@pageTitle</h3>
                                @if (!string.IsNullOrEmpty(pageDesc))
                                {
                                    <p class="text-gray-600 text-sm mb-2">@pageDesc</p>
                                }
                                <div class="flex flex-wrap gap-2 mt-2">
                                    @if (hasMultiTable)
                                    {
                                        <span class="inline-block bg-green-100 text-green-700 text-xs px-2 py-1 rounded">
                                            <i class="fas fa-database mr-1"></i>å¤šè¡¨ CRUD
                                        </span>
                                    }
                                    @if (hasDataLoading)
                                    {
                                        <span class="inline-block bg-blue-100 text-blue-700 text-xs px-2 py-1 rounded">
                                            <i class="fas fa-sync mr-1"></i>æ•°æ®åŠ è½½
                                        </span>
                                    }
                                </div>
                            </div>
                        </div>
                    </a>
                }
            </div>
        </div>
    }

    <!-- Multi-Table Form Examples Section -->
    <div class="mb-12">
        <h2 class="text-2xl font-bold text-gray-800 mb-6">
            <i class="fas fa-flask mr-2"></i>Multi-Table Form Examples
        </h2>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            <a href="/page/OrderManagement?lang=@currentLang" class="card rounded-xl p-6 transition-all duration-300 border border-indigo-200 hover:border-indigo-400 hover:shadow-md">
                <div class="flex items-start">
                    <div class="bg-indigo-100 p-3 rounded-lg mr-4">
                        <i class="fas fa-shopping-cart text-indigo-600 text-xl"></i>
                    </div>
                    <div class="flex-1">
                        <h3 class="text-lg font-semibold text-gray-800 mb-1">è®¢å•ç®¡ç†</h3>
                        <p class="text-gray-600 text-sm mb-2">è®¢å• + è®¢å•æ˜ç»†ï¼ˆä¸€å¯¹å¤šï¼‰</p>
                        <div class="flex flex-wrap gap-2 mt-2">
                            <span class="inline-block bg-green-100 text-green-700 text-xs px-2 py-1 rounded">
                                åˆ†é¡µ
                            </span>
                            <span class="inline-block bg-blue-100 text-blue-700 text-xs px-2 py-1 rounded">
                                ç¼–è¾‘
                            </span>
                        </div>
                    </div>
                </div>
            </a>

            <a href="/page/OrderCustomer?lang=@currentLang" class="card rounded-xl p-6 transition-all duration-300 border border-pink-200 hover:border-pink-400 hover:shadow-md">
                <div class="flex items-start">
                    <div class="bg-pink-100 p-3 rounded-lg mr-4">
                        <i class="fas fa-users text-pink-600 text-xl"></i>
                    </div>
                    <div class="flex-1">
                        <h3 class="text-lg font-semibold text-gray-800 mb-1">è®¢å•å®¢æˆ·ç®¡ç†</h3>
                        <p class="text-gray-600 text-sm mb-2">å®¢æˆ· + è®¢å• + è®¢å•æ˜ç»†ï¼ˆå¤šè¡¨å…³è”ï¼‰</p>
                        <div class="flex flex-wrap gap-2 mt-2">
                            <span class="inline-block bg-purple-100 text-purple-700 text-xs px-2 py-1 rounded">
                                å¹¶è¡ŒåŠ è½½
                            </span>
                            <span class="inline-block bg-yellow-100 text-yellow-700 text-xs px-2 py-1 rounded">
                                äº‹åŠ¡ä¿å­˜
                            </span>
                            <span class="inline-block bg-red-100 text-red-700 text-xs px-2 py-1 rounded">
                                å­—æ®µæ˜ å°„
                            </span>
                        </div>
                    </div>
                </div>
            </a>

            <a href="/Docs/MultiTableForm.md" target="_blank" class="card rounded-xl p-6 transition-all duration-300 border border-gray-200 hover:border-gray-400 hover:shadow-md">
                <div class="flex items-start">
                    <div class="bg-gray-100 p-3 rounded-lg mr-4">
                        <i class="fas fa-book text-gray-600 text-xl"></i>
                    </div>
                    <div class="flex-1">
                        <h3 class="text-lg font-semibold text-gray-800 mb-1">åŠŸèƒ½æ–‡æ¡£</h3>
                        <p class="text-gray-600 text-sm mb-2">æŸ¥çœ‹å¤šè¡¨è¡¨å•åŠŸèƒ½çš„å®Œæ•´æ–‡æ¡£</p>
                        <div class="flex flex-wrap gap-2 mt-2">
                            <span class="inline-block bg-blue-100 text-blue-700 text-xs px-2 py-1 rounded">
                                API
                            </span>
                            <span class="inline-block bg-green-100 text-green-700 text-xs px-2 py-1 rounded">
                                ç¤ºä¾‹
                            </span>
                        </div>
                    </div>
                </div>
            </a>
        </div>
    </div>

    <!-- AI Features Section -->
    <div class="mb-12">
        <h2 class="text-2xl font-bold text-gray-800 mb-6">AI Features</h2>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            <a href="/InventoryAiPage" class="card ai-card hover:shadow-md transition-shadow">
                <div class="flex items-start">
                    <div class="bg-blue-100 p-3 rounded-lg mr-4">
                        <i class="fas fa-chart-line text-blue-600 text-xl"></i>
                    </div>
                    <div>
                        <h3 class="text-lg font-semibold text-gray-800 mb-2">Inventory AI</h3>
                        <p class="text-gray-600 text-sm">AI-powered inventory management with three-layer architecture</p>
                    </div>
                </div>
            </a>

            <a href="/ai-validation" class="card ai-card hover:shadow-md transition-shadow">
                <div class="flex items-start">
                    <div class="bg-green-100 p-3 rounded-lg mr-4">
                        <i class="fas fa-shield-alt text-green-600 text-xl"></i>
                    </div>
                    <div>
                        <h3 class="text-lg font-semibold text-gray-800 mb-2">AI Validation</h3>
                        <p class="text-gray-600 text-sm">Validate and approve AI-generated suggestions</p>
                    </div>
                </div>
            </a>

            <a href="/ai-validation/snapshots" class="card ai-card hover:shadow-md transition-shadow">
                <div class="flex items-start">
                    <div class="bg-yellow-100 p-3 rounded-lg mr-4">
                        <i class="fas fa-cogs text-yellow-600 text-xl"></i>
                    </div>
                    <div>
                        <h3 class="text-lg font-semibold text-gray-800 mb-2">Snapshots</h3>
                        <p class="text-gray-600 text-sm">Review and manage AI decision snapshots</p>
                    </div>
                </div>
            </a>
        </div>
    </div>
</div>