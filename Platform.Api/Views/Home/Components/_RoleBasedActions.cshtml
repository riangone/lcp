@model dynamic
@{
    var currentLang = Context.Request.Query["lang"].FirstOrDefault() ?? "en";
    var title = Model?.Title?.GetText(currentLang) ?? "";
    var roles = Model?.Roles ?? new Dictionary<string, List<RoleActionConfig>>();
    
    // æ¨¡æ‹Ÿå½“å‰ç”¨æˆ·è§’è‰²ï¼ˆå®é™…åº”ä»è®¤è¯ç³»ç»Ÿè·å–ï¼‰
    var currentRole = "sales_rep"; // å¯ä»¥æ˜¯ sales_rep, sales_manager, service_rep
}

<div class="bg-white py-8">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        @if (!string.IsNullOrEmpty(title))
        {
            <h3 class="text-2xl font-bold text-gray-800 mb-6">@title</h3>
        }
        
        <!-- è§’è‰²åˆ‡æ¢å™¨ï¼ˆä»…æ¼”ç¤ºç”¨ï¼‰ -->
        <div class="mb-6 flex items-center space-x-2">
            <span class="text-sm text-gray-500">å½“å‰è§’è‰²:</span>
            <select id="role-switcher" class="border border-gray-300 rounded-lg px-3 py-1 text-sm" onchange="switchRole(this.value)">
                <option value="sales_rep" selected="@(currentRole == "sales_rep")">é”€å”®ä»£è¡¨</option>
                <option value="sales_manager" selected="@(currentRole == "sales_manager")">é”€å”®ç»ç†</option>
                <option value="service_rep" selected="@(currentRole == "service_rep")">å®¢æœä»£è¡¨</option>
            </select>
        </div>
        
        @foreach (var roleEntry in roles)
        {
            var roleKey = roleEntry.Key;
            var actions = roleEntry.Value ?? [];
            var displayStyle = roleKey == currentRole ? "block" : "none";
            
            <div class="role-content @(roleKey == currentRole ? "active" : "")" data-role="@roleKey" style="display: @displayStyle">
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    @foreach (var action in actions)
                    {
                        var icon = action.Icon ?? "ğŸ“‹";
                        var label = action.Label.GetText(currentLang);
                        var href = action.Href ?? "#";
                        var badge = action.Badge ?? "";
                        var color = action.Color ?? "blue";
                        
                        var colorClasses = color switch
                        {
                            "blue" => "bg-blue-50 hover:bg-blue-100 border-blue-200",
                            "amber" => "bg-amber-50 hover:bg-amber-100 border-amber-200",
                            "purple" => "bg-purple-50 hover:bg-purple-100 border-purple-200",
                            "indigo" => "bg-indigo-50 hover:bg-indigo-100 border-indigo-200",
                            "green" => "bg-green-50 hover:bg-green-100 border-green-200",
                            "pink" => "bg-pink-50 hover:bg-pink-100 border-pink-200",
                            _ => "bg-gray-50 hover:bg-gray-100 border-gray-200"
                        };
                        
                        <a href="@href" class="@colorClasses border-2 rounded-xl p-6 transition-all duration-300 hover:shadow-lg hover:-translate-y-1 block relative">
                            @if (!string.IsNullOrEmpty(badge))
                            {
                                <span class="absolute top-2 right-2 bg-red-500 text-white text-xs font-bold px-2 py-1 rounded-full">@badge</span>
                            }
                            <div class="text-3xl mb-3">@icon</div>
                            <h4 class="text-lg font-semibold text-gray-800 mb-2">@label</h4>
                        </a>
                    }
                </div>
            </div>
        }
    </div>
</div>

<script>
    function switchRole(role) {
        document.querySelectorAll('.role-content').forEach(el => {
            el.style.display = el.dataset.role === role ? 'block' : 'none';
        });
        // åœ¨å®é™…åº”ç”¨ä¸­ï¼Œè¿™é‡Œåº”è¯¥å‘é€è¯·æ±‚åˆ°æœåŠ¡å™¨è·å–è¯¥è§’è‰²çš„æ•°æ®
    }
</script>
