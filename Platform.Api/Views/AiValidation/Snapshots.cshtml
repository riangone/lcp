@model List<Platform.Infrastructure.Shell.Snapshot>
@{
    ViewData["Title"] = "Snapshot Management - Low Code Platform";
    ViewData["ActivePage"] = "AI";
}

<div class="container mx-auto px-4 py-8">
    <div class="mb-8">
        <h1 class="text-3xl font-bold text-gray-800 mb-2">@ViewBag.Model Model Pending Snapshots</h1>
        <p class="text-gray-600">Manage AI-generated snapshots to ensure data quality and compliance</p>
    </div>

    @if (Model.Count == 0)
    {
        <div class="card p-8 text-center">
            <div class="text-gray-400 mb-4">
                <i class="fas fa-history text-6xl"></i>
            </div>
            <h3 class="text-xl font-medium text-gray-900 mb-2">No Pending Snapshots</h3>
            <p class="text-gray-500 mb-6">No pending snapshots. Generate some AI suggestions first.</p>
            <a href="@Url.Action("GenerateSuggestions", "AiValidation", new { model = ViewBag.Model, id = 1 })" class="btn btn-primary inline-block">
                <i class="fas fa-plus mr-2"></i>Generate New Suggestions
            </a>
        </div>
    }
    else
    {
        <div class="card overflow-x-auto">
            <table class="table w-full">
                <thead>
                    <tr class="bg-gray-50">
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ID</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Data</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">AI Model</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Confidence</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Created At</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                    </tr>
                </thead>
                <tbody class="bg-white divide-y divide-gray-200">
                    @foreach (var snapshot in Model)
                    {
                        <tr class="hover:bg-gray-50">
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                                @snapshot.Id.Substring(0, 8)...
                            </td>
                            <td class="px-6 py-4 text-sm text-gray-900 max-w-xs">
                                <pre class="text-xs bg-gray-100 p-2 rounded overflow-x-auto max-h-20 overflow-y-auto">@snapshot.Data.ToString()</pre>
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                                @snapshot.Provenance.AiModelId
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                                @{
                                    var confidence = snapshot.Provenance.Metadata.ContainsKey("confidence")
                                        ? snapshot.Provenance.Metadata["confidence"]
                                        : "N/A";
                                }
                                @confidence
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                                @snapshot.CreatedAt.ToString("yyyy-MM-dd HH:mm:ss")
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                                <form method="post" action="@Url.Action("ApproveSnapshot", "AiValidation", new { id = snapshot.Id })" class="inline-block mr-2">
                                    <input type="hidden" name="model" value="@ViewBag.Model" />
                                    <button type="submit" class="btn btn-success">
                                        <i class="fas fa-check mr-1"></i>Approve
                                    </button>
                                </form>
                                <form method="post" action="@Url.Action("RejectSnapshot", "AiValidation", new { id = snapshot.Id })" class="inline-block">
                                    <input type="hidden" name="model" value="@ViewBag.Model" />
                                    <button type="submit" class="btn btn-danger">
                                        <i class="fas fa-times mr-1"></i>Reject
                                    </button>
                                </form>
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
    }

    <div class="flex flex-wrap gap-4 mt-6">
        <a href="@Url.Action("Index", "AiValidation")" class="btn btn-secondary">
            <i class="fas fa-arrow-left mr-2"></i>Back to AI Validation
        </a>
        <a href="@Url.Action("GenerateSuggestions", "AiValidation", new { model = ViewBag.Model, id = 1 })" class="btn btn-primary">
            <i class="fas fa-plus mr-2"></i>Generate New Suggestions
        </a>
    </div>

    <div class="card mt-8 p-6">
        <h3 class="text-lg font-semibold text-gray-800 mb-4">Provenance Tracking Information</h3>
        <p class="text-gray-600 mb-4">Each snapshot contains complete provenance information to ensure AI decision traceability:</p>
        <ul class="space-y-2">
            <li class="flex items-start">
                <i class="fas fa-check-circle text-green-500 mt-1 mr-2"></i>
                <span><strong>AI Model ID</strong>: Identifier of the AI model that made the decision</span>
            </li>
            <li class="flex items-start">
                <i class="fas fa-check-circle text-green-500 mt-1 mr-2"></i>
                <span><strong>Input Hash</strong>: Hash of the original input data to ensure data integrity</span>
            </li>
            <li class="flex items-start">
                <i class="fas fa-check-circle text-green-500 mt-1 mr-2"></i>
                <span><strong>Timestamp</strong>: Time when the decision was generated</span>
            </li>
            <li class="flex items-start">
                <i class="fas fa-check-circle text-green-500 mt-1 mr-2"></i>
                <span><strong>Metadata</strong>: Additional information including confidence, reasoning process, etc.</span>
            </li>
        </ul>
    </div>
</div>