@using Platform.Infrastructure.Definitions
@model IEnumerable<Dictionary<string, object>>
@{
    var def = (ModelDefinition)ViewData["ModelDef"]!;
    var modelName = (string)ViewData["ModelName"]!;
    var currentLang = Context.Request.Query["lang"].FirstOrDefault() ?? ViewData["Lang"] as string ?? "zh";

    var localizedLabels = currentLang == "zh"
        ? def.Ui?.Labels?.Zh
        : def.Ui?.Labels?.En;
}

<tbody id="tableBody">
    @if (!Model.Any())
    {
        <tr>
            <td colspan="@(def.List?.Columns.Count + 1 ?? 1)" class="text-center py-5">暂无数据</td>
        </tr>
    }
    else
    {
        @foreach (var item in Model)
        {
            <tr>
                @foreach (var col in def.List?.Columns ?? new List<string>())
                {
                    var value = item.ContainsKey(col) ? item[col] : "";
                    <td>@value</td>
                }
                <td class="text-center">
                    <a href="/ui/hmss/@modelName/edit/@item[def.PrimaryKey]?project=hmss" class="btn btn-sm btn-outline-primary me-1">
                        <i class="bi bi-pencil"></i> 编辑
                    </a>
                    <button type="button" class="btn btn-sm btn-outline-danger" onclick="deleteItem('@item[def.PrimaryKey]')">
                        <i class="bi bi-trash"></i> 删除
                    </button>
                </td>
            </tr>
        }
    }
</tbody>
